<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Genetic Factor Analysis"><title>Genetic Factor Analysis — gfa_fit • GFA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Genetic Factor Analysis — gfa_fit"><meta property="og:description" content="Genetic Factor Analysis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GFA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.0445</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/gfa_with_simulated_data.html">Running GFA with Simulated Data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Genetic Factor Analysis</h1>
      
      <div class="d-none name"><code>gfa_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Genetic Factor Analysis</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gfa_fit</span><span class="op">(</span></span>
<span>  Z_hat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N_case <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop_prev <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  B_hat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  params <span class="op">=</span> <span class="fu">gfa_default_parameters</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  no_wrapup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  F_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fix_F <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  freeze_F <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>Z_hat</dt>
<dd><p>A matrix of z-scores with rows for variants and columns for traits.</p></dd>


<dt>N</dt>
<dd><p>Vector of sample sizes length equal to number of traits. If not provided,
N will default to the vector of 1's and the factor matrix will be returned on the "z-score scale".</p></dd>


<dt>N_case</dt>
<dd><p>If all traits are continuous, omit this option. If some traits are binary, N_case should
be a vector with length equal to number of traits. Values should be NA for continuous traits or the number
of cases for binary traits.</p></dd>


<dt>pop_prev</dt>
<dd><p>If all traits are continuous, omit this option. If some traits are binary, pop_prev should
be a vector with length equal to number of traits. Values should be NA for continuous traits or the population
prevalence for binary traits.</p></dd>


<dt>B_hat</dt>
<dd><p>A matrix of GWAS effect estimates. B_hat is an alternative to Z_hat (only provide one of these).
If using B_hat, you must also provide S.</p></dd>


<dt>S</dt>
<dd><p>If using B_hat, provide the corresponding matrix of standard errors.</p></dd>


<dt>R</dt>
<dd><p>Estimated residual correlation matrix. This can be produced for example using R_ldsc or R_pt.</p></dd>


<dt>params</dt>
<dd><p>List of parameters. For most users this can be left at the default values. See Details.</p></dd>


<dt>no_wrapup</dt>
<dd><p>If TRUE, GFA will not perform wrap-up steps. Advanced option used for debugging.</p></dd>


<dt>F_init</dt>
<dd><p>Initial estimate of F (optional).</p></dd>


<dt>fix_F, freeze_F</dt>
<dd><p>Options for fixing F at initialization. See Details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with elements L_hat and F_hat for estimated variant-factor and factor-trait effects, gfa_pve
which contains the proportion of heritability explained by each factor, and some other objects useful internally.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>You can fit GFA using two types of data. Either supply Z_hat and N or supply B_hat and S.
In either case, GFA will be fit with z-scores as inputs and factors will be scaled to
the standardized trait scale or the liability scale for binary traits. If you supply B_hat
and S, GFA will guess the scaling factors by computing the median of the ratio of each
trait's standard errors compared with the first trait's standard errors.
If you used B_hat/S and there are some binary traits, you only need to supply pop_prev.
If you use Z_hat/N and there are some binary traits, you must supply both N_case and pop_prev.
We recommend using the Z_hat/N option if sample sizes are available.</p>
<p>The params list includes the following elements which can be modified.
Most users will not need to modify any of these, except possibly `max_iter`.</p>
<p>kmax: Maximum number of factors. Defaults to twice the number of traits</p>
<p>cond_num: Maximum allowable condition number for R. Defaults to 1000.</p>
<p>max_iter: Maximum number of iterations. Defaults to 1000.</p>
<p>extrapolate: Passed to flashier, defaults to TRUE</p>
<p>ebnm_fn_F and ebnm_fn_L: Prior families for factors and loadings. Defaults to point-normal.</p>
<p>init_fn: Flashier initialization function.</p>
<p>fix_F and freeze_F provide different ways to fix initial estimates. If fix_F is TRUE, the factors
supplied to F_init will not be updated. However, GFA will be allowed to add additional factors to the final fit.
If freeze_F is TRUE, GFA will not add additional factors and the final value of F_hat will be equal to F_init
up to column scaling constants.</p>
<p>The returned object will be a list with the following elements: F_hat (factor estimate), L_hat (loadings estimate), F_hat_single (the columns of
F_hat corresponding to single trait factors), F_hat_multi (the columns of F corresponding to multi-trait factors), fit (a flashier object),
scale (the scaling factor used), method (internal method type). If there are more than zero factors, the object will also include gfa_pve which
includes genet_var (the total variance explained by the set of variants used in estimation) and pve which is a traits by factors matrix.
The (i,j) element of pve gives the proportion of trait i hertiability explained by factor j.</p>
<p>To compute credible intervals for pve, see gfa_intervals().
To compute GLS estimates of factor loadings see gfa_loadings_gls().</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jean Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

